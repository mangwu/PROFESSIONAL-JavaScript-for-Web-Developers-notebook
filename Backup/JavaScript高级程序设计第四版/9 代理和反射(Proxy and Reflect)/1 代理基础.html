<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>1. ä»£ç†åŸºç¡€</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	text-indent: -1.7em;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-opaquegray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style><link rel="stylesheet" href="../../style.css"></head><body><article id="fcb96ccd-b73c-47c2-a84a-e49d6c791c16" class="page sans"><header><img class="page-cover-image" src="https://www.notion.so/images/page-cover/webb2.jpg" style="object-position:center 70%"/><div class="page-header-icon page-header-icon-with-cover"><span class="icon">ğŸ</span></div><h1 class="page-title">1. ä»£ç†åŸºç¡€</h1></header><div class="page-body"><p id="002f9516-71c6-4565-a8f6-37ff6a8ed44c" class=""><strong>ä»£ç†ï¼ˆProxyï¼‰æ˜¯ç›®æ ‡å¯¹è±¡çš„æŠ½è±¡ï¼Œ</strong>ä¸å…¶å®ƒè¯­è¨€è¿›è¡Œç±»æ¯”ï¼Œä»£ç†å°±åƒæ˜¯C++æŒ‡é’ˆï¼Œå› ä¸ºå®ƒ<strong>å¯ç”¨ä½œç›®æ ‡å¯¹è±¡çš„æ›¿èº«ï¼Œä½†åˆå®Œå…¨ç‹¬ç«‹äºç›®æ ‡å¯¹è±¡</strong></p><p id="f61d7518-c10d-40c8-8af2-a668c0fa3ac4" class="">ç›®æ ‡å¯¹è±¡å¯ä»¥ç›´æ¥è¢«æ“ä½œï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä»£ç†æ¥æ“ä½œï¼Œä½†æ˜¯ç›´æ¥æ“ä½œä¼šç»•è¿‡ä»£ç†æ–½äºˆçš„è¡Œä¸º</p><p id="7a2f7535-1cd3-43ba-b800-7e3cf28f8910" class="block-color-gray_background"><strong>æ³¨æ„ </strong>ESä¸­çš„ä»£ç† å’Œ C++ ä¸­çš„æŒ‡é’ˆæœ‰é‡å¤§çš„åŒºåˆ«, ä¸Šè¿°åªæ˜¯åšä¸€ç§æœ‰åŠ©äºç†è§£çš„å¯¹æ¯”ï¼ŒæŒ‡é’ˆåœ¨æ¦‚å¿µä¸Šæ˜¯ç±»æ¯”æ¯”è¾ƒåˆé€‚çš„ç»“æ„</p><h1 id="ad9093c5-44d3-433b-8f32-ddba42de7107" class="">1.0 MDN-<code>Proxy</code> å†…ç½®å¯¹è±¡çš„æè¿°</h1><figure id="b30cae29-5188-49fc-9178-c3fd05c5d724" class="link-to-page"><a href="1%20%E4%BB%A3%E7%90%86%E5%9F%BA%E7%A1%80/Proxy.html"><span class="icon">ğŸ†</span>Proxy</a></figure><div id="dbdc2a36-ee41-4223-bae7-656e8b3f4ada" class="column-list"><div id="d0b2f194-27c5-451f-8729-2ebc46ffecf0" style="width:18.75%" class="column"><nav id="0c3f1178-cf09-450a-8323-d5009baa50c5" class="block-color-gray table_of_contents"><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#ad9093c5-44d3-433b-8f32-ddba42de7107">1.0 MDN-<code>Proxy</code> å†…ç½®å¯¹è±¡çš„æè¿°</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2c2cd874-2abe-439f-9928-de0a70a4b965">1.1 åˆ›å»ºç©ºä»£ç†</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#7ffd2c28-eeca-4d99-baa2-b6288cae0d93">1.2 å®šä¹‰æ•è·å™¨</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#76f66067-9a28-46bf-8191-b5eb737db226">1.3 æ•è·å™¨å‚æ•°å’Œåå°„API</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#5f312150-06b5-4d7d-b618-33de6bbd5fe9">1.3.1 æ•è·å™¨å‚æ•°</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#86e3dc09-a4c0-4078-826f-4fb5c30a333d">1.3.2 åå°„API</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#23c8ffc0-8f7c-4199-b4d1-0577a5b30fee">1.4 æ•è·å™¨ä¸å˜å¼ï¼ˆtrap invariantï¼‰</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#5ae8a461-4330-4185-a027-4ebc7e5b31b6">1.5 å¯æ’¤é”€ä»£ç†</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#212f6fbe-be73-495c-bed1-effe2603b7c1">1.6 MDN-<code>Reflect</code>å†…ç½®å¯¹è±¡æè¿°</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#48fa6870-7374-402d-8503-344c9e222d9f">1.7 å®ç”¨åå°„APIï¼ˆUtility of the Reflect APIï¼‰</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#c2a6fde3-a9bc-4f75-9804-dc91e43da969">1.7.1 åå°„APIä¸å¯¹è±¡APIï¼ˆReflect API and Object APIï¼‰</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#52f2d9f9-8917-4f53-8ad1-cf2c908cda15">1.7.2 çŠ¶æ€æ ‡è®°</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#b807187a-af5c-4681-8b16-4a709f76ee28">1.7.3 ç”¨ä¸€ç­‰å‡½æ•°æ›¿ä»£æ“ä½œç¬¦ï¼ˆSupplanting Operators with First-Class Functionsï¼‰</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#b80f12ea-8783-4f85-a463-ca5415e7d72a">1.7.4 å®‰å…¨åœ°åº”ç”¨å‡½æ•°</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#4d0a5957-7052-48ad-8144-09ffd8f6e48c">1.8 ä»£ç†å¦ä¸€ä¸ªä»£ç†(Proxying a Proxy)</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#7774fc50-02d2-4720-94b3-19271309dd6f">1.9 ä»£ç†çš„é—®é¢˜ä¸ä¸è¶³ï¼ˆConsiderations and Shortcomingsï¼‰</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#31ae0846-b2dc-4167-adb6-6f2793a4be34">1.9.1 ä»£ç†ä¸­çš„this</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#ba0bb84d-363c-411c-94ad-c588271b8008">1.9.2 ä»£ç†ä¸å†…éƒ¨æ§½ä½ï¼ˆInternal Slotsï¼‰</a></div></nav><p id="2aadc0a1-0f9f-4706-a907-1ba487294542" class="">
</p></div><div id="f4870645-dfcd-4ee5-a794-122ece6e27b7" style="width:81.25%" class="column"><h1 id="2c2cd874-2abe-439f-9928-de0a70a4b965" class="">1.1 åˆ›å»ºç©ºä»£ç†</h1><ul id="152cb9cf-f2fd-41a8-8839-0e5e8bccb6a9" class="bulleted-list"><li style="list-style-type:disc">ç©ºä»£ç†ï¼Œå°±æ˜¯<strong>ä¸æ‹¦æˆª</strong>ä»»ä½•æ“ä½œï¼Œåœ¨ä»£ç†å¯¹è±¡ä¸Šæ‰§è¡Œçš„æ‰€æœ‰æ“ä½œéƒ½ä¼šæ— éšœç¢çš„<strong>è½¬å‘</strong>ï¼ˆ<strong>forward</strong>ï¼‰åˆ°ç›®æ ‡å¯¹è±¡ä¸Šï¼Œç©ºä»£ç†åˆç§°<strong>æ— æ“ä½œè½¬å‘ä»£ç†ï¼ˆno-op forwarding proxyï¼‰</strong></li></ul><ul id="179bbfd7-8f21-40d2-8524-4e2e05b88a4b" class="bulleted-list"><li style="list-style-type:disc">åœ¨ä»»ä½•å¯ä»¥ä½¿ç”¨ç›®æ ‡å¯¹è±¡çš„åœ°æ–¹ï¼Œéƒ½å¯ä»¥é€šè¿‡åŒæ ·çš„æ–¹å¼ä½¿ç”¨ä¸ä¹‹å…³è”çš„<strong>æ— æ“ä½œè½¬å‘ä»£ç†</strong></li></ul><p id="62ea7f9d-dbfa-4444-9887-d5273b881a0b" class=""><strong>Proxyè¯­æ³•</strong></p><ul id="999e9778-6c84-40ee-92ac-01a5eaa8eb98" class="bulleted-list"><li style="list-style-type:disc"><code>Proxy</code> æ˜¯ç”¨äºåˆ›å»ºä»£ç†å¯¹è±¡çš„æ„é€ å‡½æ•°ï¼Œè¯­æ³•å¦‚ä¸‹<pre id="a73686fc-4413-4d66-8ece-65cb4ea3c37f" class="code code-wrap"><code>new Proxy(target, handler);</code></pre><ul id="0769fe70-deed-485d-bc89-9682b0c98b6c" class="bulleted-list"><li style="list-style-type:circle"><code>target</code> : ç›®æ ‡å¯¹è±¡ï¼Œæˆ–ç§° è¢«ä»£ç†çš„æºå¯¹è±¡</li></ul><ul id="b5dcf326-47e9-42e2-99d5-1647d76e1bb3" class="bulleted-list"><li style="list-style-type:circle"><code>handler</code> ï¼šå¤„ç†ç¨‹åºå¯¹è±¡ï¼Œå®šä¹‰ä»£ç†éœ€è¦æ‹¦æˆªï¼ˆinterceptï¼‰çš„ä¸€äº›æ“ä½œä»¥åŠ<strong>é‡æ–°å®šä¹‰</strong>ï¼ˆ<strong>redefine</strong>ï¼‰<strong>æ‹¦æˆªä¸‹æ¥çš„æ“ä½œ</strong>ï¼ˆ<strong>intercepted operations</strong>ï¼‰</li></ul></li></ul><ul id="2b7a8d7e-43e1-473d-8130-59a8f7ac232b" class="bulleted-list"><li style="list-style-type:disc">åˆ›å»ºç©ºä»£ç†ï¼šä¼ é€’ä¸€ä¸ªç®€å•å¯¹è±¡å­—é¢é‡ä½œä¸ºå¤„ç†ç¨‹åºå¯¹è±¡ï¼Œä»è€Œè®©æ‰€æœ‰æ“ä½œç•…é€šæ— é˜»åœ°æŠµè¾¾ç›®æ ‡å¯¹è±¡</li></ul><p id="8d25c741-007b-4b9f-86d8-273edfe94138" class=""><strong>ä¾‹å­</strong></p><ul id="fc962850-97ae-4a62-995b-c34ee2a0768b" class="bulleted-list"><li style="list-style-type:disc">ä¸‹é¢ä»£ç ï¼Œåœ¨ä»£ç†å¯¹è±¡ä¸Šæ‰§è¡Œåœ°ä»»ä½•æ“ä½œéƒ½ä¼šå®é™…è½¬å‘åˆ°ç›®æ ‡å¯¹è±¡ä¸Šï¼Œå”¯ä¸€æ„ŸçŸ¥çš„ä¸åŒå°±æ˜¯ä»£ç ä¸­æ“ä½œçš„æ˜¯ä»£ç†å¯¹è±¡è€Œéç›®æ ‡å¯¹è±¡<pre id="a6fb97a9-ac0c-4308-8990-3ef3f2be604c" class="code code-wrap"><code>// ç©ºä»£ç†
const target = {
  id: &quot;target&quot;,
};

// æ— æ“ä½œè½¬å‘ä»£ç†
const proxy = new Proxy(target, {});

// åœ¨proxyä¸Šçš„å¯¹è±¡æ“ä½œä¼šè½¬å‘åˆ°targetä¸Š
console.log(proxy.id); // target
console.log(target.id); // target

proxy.id = &quot;foo&quot;;

console.log(proxy.id); // foo
console.log(target.id); // foo

// ä½¿ç”¨æ–¹æ³•åˆ¤æ–­ä»£ç†æ˜¯å¦åŒ…å«idå±æ€§ï¼Œä»£ç†ä¼šå°†æ”¹åˆ¤æ–­æ“ä½œè½¬å‘åˆ°ç›®æ ‡å¯¹è±¡ä¸Š
console.log(target.hasOwnProperty(&quot;id&quot;)); // true
console.log(proxy.hasOwnProperty(&quot;id&quot;)); // true

// Proxy.prototypeæ˜¯undefined,å› æ­¤ä¸èƒ½ä½¿ç”¨instanceof åˆ¤æ–­ä»£ç†
// ä»£ç†å®ä¾‹çš„åŸå‹[[Prototype]]æ˜¯Object.prototype(è¿™ä¹Ÿæ˜¯èƒ½ä½¿ç”¨hasOwnPropertyçš„åŸå› )
try {
  console.log(proxy instanceof Proxy);
} catch (error) {
  console.log(error.toString()); 
// TypeError: Function has non-object prototype &#x27;undefined&#x27; in instanceof check
}
console.log(proxy.__proto__ === Object.prototype); // true

// ä»£ç†å’Œæºå¯¹è±¡æ˜¯ä¸¤ä¸ªä¸åŒçš„å¯¹è±¡ï¼Œåªæ˜¯æ“ä½œç©ºä»£ç†èƒ½å°†æ“ä½œè½¬å‘åˆ°æºå¯¹è±¡ä¸Š
console.log(target === proxy); // false</code></pre></li></ul><h1 id="7ffd2c28-eeca-4d99-baa2-b6288cae0d93" class="">1.2 å®šä¹‰æ•è·å™¨</h1><p id="d8da256f-58c5-4a6c-9754-39004dd23fdf" class=""><strong>ç†è§£æ•è·å™¨</strong></p><ul id="fb241872-0176-44a6-a6f6-f39e2617988d" class="bulleted-list"><li style="list-style-type:disc"><strong>æ•è·å™¨ï¼Œtrapï¼Œ</strong>å®ƒæ˜¯å®šä¹‰åœ¨<strong>å¤„ç†ç¨‹åºå¯¹è±¡</strong>ï¼ˆ<strong>handler</strong>ï¼‰ä¸Šçš„ç”¨äº<strong>æ‹¦æˆª</strong>ï¼ˆ<strong>intercept</strong>ï¼‰å¯¹æºå¯¹è±¡çš„æ“ä½œï¼Œå¹¶é‡æ–°å®šä¹‰æ‹¦æˆªä¸‹æ¥çš„æ“ä½œï¼ˆ<strong>intercepted operations</strong>ï¼‰ï¼›</li></ul><ul id="b5c8600a-1fbd-47ac-bf00-aaf2e67acca4" class="bulleted-list"><li style="list-style-type:disc">å¯¹ä»£ç†è¿›è¡Œçš„æ“ä½œç»è¿‡æ‹¦æˆªåä¼šè¢«é‡æ–°å®šä¹‰å¹¶è½¬å‘åˆ°æºå¯¹è±¡ä¸Šå†è¿›è¡Œä¿®æ­£æ“ä½œï¼Œè€Œæ‹¦æˆªå¹¶ä¿®æ”¹å¯¹è±¡çš„åŸºæœ¬æ“ä½œçš„å‡½æ•°å°±æ˜¯<strong>æ•è·å™¨ï¼ˆtrapï¼‰</strong>ï¼Œå®ƒä»¬éƒ½å®šä¹‰åœ¨å¤„ç†ç¨‹åºå¯¹è±¡ä¸­</li></ul><ul id="b2aa8ccd-36e4-452d-b88b-12a1ec5cf2f1" class="bulleted-list"><li style="list-style-type:disc">æ¯ä¸ªå¤„ç†ç¨‹åºå¯¹è±¡ï¼ˆhandlerï¼‰å¯ä»¥åŒ…æ‹¬0ä¸ªæˆ–å¤šä¸ªæ•è·å™¨ï¼Œæ¯ä¸ªæ•è·å™¨å¯¹åº”ä¸€ç§åŸºæœ¬çš„æ“ä½œï¼Œå¯ä»¥ç›´æ¥æˆ–é—´æ¥åœ¨ä»£ç†å¯¹è±¡ä¸Šè°ƒç”¨</li></ul><ul id="f2d63dfa-01cb-405c-aaf1-9224aa1f2c7f" class="bulleted-list"><li style="list-style-type:disc">æ¯æ¬¡åœ¨ä»£ç†å¯¹è±¡ä¸Šè°ƒç”¨è¿™äº›åŸºæœ¬æ“ä½œæ—¶ï¼Œä»£ç†ä¼š<strong>å…ˆè°ƒç”¨å¤„ç†ç¨‹åºå¯¹è±¡ä¸­çš„æ•è·å™¨å‡½æ•°</strong>ï¼Œæ‹¦æˆªéƒ¨åˆ†æ“ä½œï¼Œå¹¶ä¿®æ”¹ç›¸åº”çš„è¡Œä¸ºï¼Œå…¶å®ƒæœªè¢«æ‹¦æˆªçš„æ“ä½œä»ç„¶ä¼šè¢«è½¬å‘åˆ°ç›®æ ‡å¯¹è±¡â€˜</li></ul><figure class="block-color-red_background callout" style="white-space:pre-wrap;display:flex" id="3a15be7f-8b6b-4b66-85a7-20e720585cc1"><div style="font-size:1.5em"><span class="icon">ğŸ’¡</span></div><div style="width:100%">æ³¨æ„ï¼šæ•è·å™¨æ˜¯ä»æ“ä½œç³»ç»Ÿä¸­å€Ÿç”¨çš„æ¦‚å¿µã€‚åœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œæ•è·å™¨æ˜¯ç¨‹åºæµä¸­çš„ä¸€ä¸ªåŒæ­¥ä¸­æ–­ï¼Œå¯ä»¥æš‚åœç¨‹åºæµï¼Œè½¬è€Œæ‰§è¡Œä¸€æ®µå­ä¾‹ç¨‹ï¼Œä¹‹åå†è¿”å›åŸå§‹ç¨‹åºæµ</div></figure><p id="3c241a96-9eb6-49f9-b0fa-2de504ef5193" class=""><strong>æ‰€æœ‰æ•è·å™¨</strong></p><ul id="d18a3097-17fe-4258-b872-df8c98356aee" class="bulleted-list"><li style="list-style-type:disc">è¿™é‡Œåªåˆ—å‡ºæ‰€æœ‰çš„æ•è·å™¨ï¼Œè¯¦ç»†ä»‹ç»å†ç¬¬äºŒç« </li></ul><div><table id="f1a0d363-c6d4-4f6b-993b-50d8146c9f0b" class="simple-table"><tbody><tr id="04049a6b-830c-42b1-b94b-4b09106fb5ab"><td id="IDVK" class="" style="width:255.99998474121094px">trap(æ•è·å™¨æ–¹æ³•)</td><td id="ARk]" class="" style="width:482.9573669433594px">descriptionï¼ˆç®€å•æè¿°ï¼‰</td></tr><tr id="f395d273-dcaf-45be-9130-520351bdd280"><td id="IDVK" class="" style="width:255.99998474121094px">handler.apply()</td><td id="ARk]" class="" style="width:482.9573669433594px">æ‹¦æˆªæºå¯¹è±¡çš„å‡½æ•°è°ƒç”¨</td></tr><tr id="01de9d9b-085d-48f2-912d-c45bdbad6895"><td id="IDVK" class="" style="width:255.99998474121094px">handler.construct()</td><td id="ARk]" class="" style="width:482.9573669433594px"><code>new</code> æ“ä½œç¬¦çš„æ•è·å™¨ï¼Œ<code>new target</code> ä¸€å®šè¦åˆæ³•æ‰èƒ½è¢«æ‹¦æˆªï¼Œæ‰€ä»¥<code>target</code> ä¸€èˆ¬æ˜¯æ„é€ å‡½æ•°æˆ–ç±»ï¼ˆæœ‰[[Construct]]å†…éƒ¨æ–¹æ³•ï¼‰</td></tr><tr id="7f41c7b3-4397-43ec-92c2-113408d3dbbc"><td id="IDVK" class="" style="width:255.99998474121094px">handler.defineProperty()</td><td id="ARk]" class="" style="width:482.9573669433594px">æ‹¦æˆªæºå¯¹è±¡å®šä¹‰å±æ€§çš„æ“ä½œï¼Œå®ƒæ˜¯<code>Object.defineProperty()</code> çš„æ•è·å™¨</td></tr><tr id="144b72cb-7dea-4a05-8bac-cf9eee7e89f5"><td id="IDVK" class="" style="width:255.99998474121094px">handler.deleteProperty()</td><td id="ARk]" class="" style="width:482.9573669433594px">æ‹¦æˆªæºå¯¹è±¡åˆ é™¤å±æ€§çš„æ“ä½œï¼Œå®ƒæ˜¯<code>delete</code> æ“ä½œç¬¦çš„æ•è·å™¨</td></tr><tr id="98e93866-9b1b-43a7-9bc9-6def01ec864c"><td id="IDVK" class="" style="width:255.99998474121094px">handler.get()</td><td id="ARk]" class="" style="width:482.9573669433594px">æ‹¦æˆªæºå¯¹è±¡è·å–å±æ€§å€¼çš„æ“ä½œ</td></tr><tr id="1c61115a-31d6-42e7-8a8c-2bbb52697118"><td id="IDVK" class="" style="width:255.99998474121094px">handler.getOwnPropertyDescriptor()</td><td id="ARk]" class="" style="width:482.9573669433594px">æ‹¦æˆªæºå¯¹è±¡è·å–å±æ€§çš„å±æ€§æè¿°ç¬¦çš„æ“ä½œï¼Œä»–æ˜¯<code>Object.getOwnPropertyDescriptor()</code> çš„æ•è·å™¨</td></tr><tr id="937e4901-fa0f-4b42-95f8-60bc428bcd1c"><td id="IDVK" class="" style="width:255.99998474121094px">handler.getPrototypeOf()</td><td id="ARk]" class="" style="width:482.9573669433594px">æ‹¦æˆªæºå¯¹è±¡è·å–è‡ªèº«åŸå‹çš„æ“ä½œï¼Œå®ƒæ˜¯<code>Object.getPrototypeOf()</code> çš„æ•è·å™¨</td></tr><tr id="61621722-c878-4f26-be25-6132d108bdbb"><td id="IDVK" class="" style="width:255.99998474121094px">handler.has()</td><td id="ARk]" class="" style="width:482.9573669433594px">æ‹¦æˆªæºå¯¹è±¡åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŸä¸€å±æ€§çš„æ“ä½œï¼Œå®ƒæ˜¯<code>in</code> æ“ä½œç¬¦çš„æ•è·å™¨</td></tr><tr id="d67c56fa-4461-42b0-924f-1f8f5df1c540"><td id="IDVK" class="" style="width:255.99998474121094px">handler.isExtensible()</td><td id="ARk]" class="" style="width:482.9573669433594px">æ‹¦æˆªæºå¯¹è±¡åˆ¤æ–­è‡ªèº«æ˜¯å¦æ˜¯å¯æ‰©å±•çš„æ“ä½œï¼Œå®ƒæ˜¯<code>Obejct.isExtensible()</code> çš„æ•è·å™¨</td></tr><tr id="ff666e73-7540-4eef-8c36-fe0da071b136"><td id="IDVK" class="" style="width:255.99998474121094px">handler.ownKeys()</td><td id="ARk]" class="" style="width:482.9573669433594px">æ‹¦æˆªæºå¯¹è±¡è·å–è‡ªèº«æ‰€æœ‰å±æ€§ï¼ˆåŒ…æ‹¬ç¬¦å·å±æ€§ï¼‰çš„æ“ä½œï¼Œå®ƒæ˜¯<code>Reflect.ownKeys()</code> çš„æ•è·å™¨</td></tr><tr id="7a37f54a-6649-48c1-b6f2-1e438a33a50e"><td id="IDVK" class="" style="width:255.99998474121094px">handler.preventExtensions()</td><td id="ARk]" class="" style="width:482.9573669433594px">æ‹¦æˆªæºå¯¹è±¡å°†è‡ªèº«å˜ä¸ºä¸å¯æ‰©å±•çš„æ“ä½œï¼Œ å®ƒæ˜¯<code>Object.preventExtensions()</code> çš„æ•è·å™¨</td></tr><tr id="8f3f1856-d8bd-4dee-a122-29aa7146f1da"><td id="IDVK" class="" style="width:255.99998474121094px">handler.set()</td><td id="ARk]" class="" style="width:482.9573669433594px">æ‹¦æˆªå¯¹è±¡è®¾ç½®å±æ€§å€¼çš„æ“ä½œ</td></tr><tr id="717058bd-fb32-4f2b-88c3-c7761bc5d3c0"><td id="IDVK" class="" style="width:255.99998474121094px">handler.setPrototypeOf()</td><td id="ARk]" class="" style="width:482.9573669433594px">æ‹¦æˆªå¯¹è±¡è®¾ç½®è‡ªèº«åŸå‹çš„æ“ä½œï¼Œå®ƒæ˜¯<code>Object.setPrototypeOf()</code>çš„æ•è·å™¨</td></tr></tbody></table></div><p id="709c15ed-24d6-48d0-9679-d37d7f3208fe" class=""><strong>ä¾‹å­</strong></p><ul id="db90d674-23e2-40de-bbc6-4424ba384cd0" class="bulleted-list"><li style="list-style-type:disc">æœ€ç®€å•çš„ä¾‹å­å°±æ˜¯å®šä¹‰ä¸€ä¸ª<code>handler.get()</code> æ•è·ï¼Œè®©ä»£ç†æ‹¦æˆªå¯¹è±¡çš„è®¿é—®å±æ€§<pre id="c1283f85-c9ed-4f1d-afab-2d871c35f9d5" class="code code-wrap"><code>// å®šä¹‰æ•è·å™¨
const target = {
  message: &quot;hello, world&quot;,
};

const handler = {
  // getæ•è·å™¨
  get() {
    return &quot;handler override&quot;;
  },
};

const proxy = new Proxy(target, handler);</code></pre></li></ul><ul id="fb1e3bc0-9a93-4aba-beab-84caf674fcb8" class="bulleted-list"><li style="list-style-type:disc">è¿™æ ·ä½†é€šè¿‡ä»£ç†æƒ³è¦è¿›è¡Œæºå¯¹è±¡å±æ€§çš„è®¿é—®æ—¶ï¼Œå°±ä¼šè§¦å‘å®šä¹‰çš„<code>get()</code> æ•è·å™¨</li></ul><ul id="0c849cb0-6d2f-49b6-b717-6d18357372a5" class="bulleted-list"><li style="list-style-type:disc">è®¿é—®å¯¹è±¡çš„å±æ€§æœ‰å¯ä»¥é€šè¿‡å¤šç§å½¢å¼è§¦å‘å¹¶è¢«<code>get()</code> æ•è·å™¨æ‹¦æˆªåˆ°ï¼Œä¾‹å¦‚<code>proxy[prop]</code>ã€<code>proxy.prop</code>ã€<code>Object.create(proxy)[prop]</code>ç­‰æ“ä½œéƒ½ä¼šè§¦å‘åŸºæœ¬çš„<code>get</code>æ“ä½œä»¥è·å–å±æ€§ï¼Œæ‰€ä»¥è¿™äº›è®¿é—®æ“ä½œåªè¦å‘ç”Ÿå†ä»£ç†å¯¹è±¡ä¸Šå°±ä¼šè§¦å‘<code>get()</code> æ•è·å™¨ï¼Œåœ¨æºå¯¹è±¡è®¿é—®å±æ€§ä»ç„¶æ˜¯æ­£å¸¸çš„è¡Œä¸º<pre id="fb6e2607-cb3b-4eb6-a4c2-cdf34d4f6049" class="code code-wrap"><code>const proxy = new Proxy(target, handler);

console.log(target.message); // hello, world
console.log(proxy.message); // handler override

console.log(Object.create(target).message); // hello, world
console.log(Object.create(proxy).message); // handler override</code></pre></li></ul><h1 id="76f66067-9a28-46bf-8191-b5eb737db226" class="">1.3 æ•è·å™¨å‚æ•°å’Œåå°„API</h1><h2 id="5f312150-06b5-4d7d-b618-33de6bbd5fe9" class="">1.3.1 æ•è·å™¨å‚æ•°</h2><ul id="403da477-29b8-4cb3-b238-ed50e5e94f82" class="bulleted-list"><li style="list-style-type:disc">æ•è·å™¨æ–¹æ³•æ˜¯æœ‰é»˜è®¤å‚æ•°çš„ï¼ŒåŸºäºè¿™äº›å‚æ•°å¯ä»¥<strong>é‡å»ºè¢«æ•è·æ–¹æ³•çš„åŸå§‹è¡Œä¸º</strong>æˆ–<strong>è‡ªå®šä¹‰å…¶å®ƒè¡Œä¸º</strong></li></ul><ul id="607ba6b1-0251-4b64-a586-efc0c3ab8bf1" class="bulleted-list"><li style="list-style-type:disc"><code>handler.get()</code> å…·æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œå¦‚ä¸‹<pre id="b60e26e5-919f-4481-8953-51808d064156" class="code code-wrap"><code>get(target, prop, receiver)</code></pre><ul id="0b9f2dfe-100d-4bf4-84ee-633c84ac218f" class="bulleted-list"><li style="list-style-type:circle"><code>target</code> æ•è·å™¨æ¥å—åˆ°çš„ç›®æ ‡å¯¹è±¡ï¼ˆä»£ç†å…³è”çš„æºå¯¹è±¡ï¼‰</li></ul><ul id="2ddbb894-f01a-4d74-ac59-340e7da41a1f" class="bulleted-list"><li style="list-style-type:circle"><code>prop</code> è¦æŸ¥è¯¢çš„å±æ€§åç§°</li></ul><ul id="2d0a72a1-d511-4de3-9f2b-db57d638a282" class="bulleted-list"><li style="list-style-type:circle"><code>receiver</code> ä»£ç†å¯¹è±¡æˆ–ç»§æ‰¿ä»£ç†çš„å¯¹è±¡</li></ul></li></ul><p id="3970b690-d6ae-4ca7-af4e-d90ec1b616ae" class=""><strong>ä¾‹å­</strong></p><pre id="9461407f-a480-4b0b-b5d6-7296b167d03c" class="code code-wrap"><code>const target = {
  foo: &quot;foo&quot;,
};
const handler = {
  get(trapTarget, prop, receiver) {
    console.log(trapTarget === target);
    console.log(prop);
    console.log(receiver === proxy);
  },
};
const proxy = new Proxy(target, handler);
proxy.foo;
// æ‰“å°
true
foo
true</code></pre><ul id="c9729003-7722-4ffb-8119-9d379e1d8d3c" class="bulleted-list"><li style="list-style-type:disc">ä¸Šè¿°ä¾‹å­è¯´æ˜äº†ä¸‰ä¸ªå‚æ•°çš„å€¼ï¼Œé€šè¿‡è¿™ä¸‰ä¸ªå‚æ•°å°±èƒ½é‡å»ºè¢«æ•è·æ–¹æ³•çš„åŸå§‹è¡Œä¸º</li></ul><pre id="d7ac6dfb-377a-4cc3-89ba-5f2ee7487dc4" class="code code-wrap"><code>const handler2 = {
  get(trapTarget, prop, receiver) {
    return trapTarget[prop];
  },
};

const proxy2 = new Proxy(target, handler2);
console.log(proxy2.foo); // foo
console.log(target.foo); // foo</code></pre><h2 id="86e3dc09-a4c0-4078-826f-4fb5c30a333d" class="">1.3.2 åå°„API</h2><ul id="aa7cf08c-98d3-481c-8637-08fbc198dd74" class="bulleted-list"><li style="list-style-type:disc"><code>Reflect</code>ä¸ºæ‰€æœ‰<strong>å¯æ‹¦æˆªçš„</strong>ï¼ˆ<strong>interceptable</strong>ï¼‰JavaScriptæ“ä½œæä¾›æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•å’Œ<code>proxy</code> çš„å¤„ç†ç¨‹åºå¯¹è±¡å®Œå…¨ä¸€æ ·ï¼›<code>Reflect</code>ä¸æ˜¯ä¸€ä¸ªæ–¹æ³•å¯¹è±¡ï¼Œå®ƒ<strong>ä¸å¯æ„é€ ï¼ˆ</strong>not <strong>constructible</strong>ï¼‰</li></ul><ul id="3e14a4fb-edef-4105-b21d-9cdac2988283" class="bulleted-list"><li style="list-style-type:disc">æ‰€æœ‰çš„æ•è·å™¨éƒ½èƒ½åŸºäºè‡ªå·±çš„å‚æ•°é‡å»ºåŸå§‹æ“ä½œï¼Œä½†æ˜¯ä¸æ˜¯æ‰€æœ‰æ•è·å™¨é‡å»ºåŸå‹æ“ä½œçš„è¿‡ç¨‹éƒ½åƒ<code>get()</code> ä¸€æ ·ç®€å•</li></ul><ul id="ca1aa08b-2491-4af0-aaf3-3514c6d3b997" class="bulleted-list"><li style="list-style-type:disc">å› æ­¤æƒ³è¦é€šè¿‡æ‰‹å†™ä»£ç å®ç°æ¯ä¸ªè¢«æ•è·æ–¹æ³•çš„åŸå§‹è¡Œä¸ºæ˜¯ä¸ç°å®çš„ï¼Œä¸ºæ­¤ECMAScript 6 æä¾›äº†ä¸€ä¸ªå…¨å±€å¯¹è±¡<code>Reflect</code> å®ƒå°è£…äº†æ‰€æœ‰åŸºäºå¯¹è±¡æ“ä½œçš„åŸå§‹è¡Œä¸ºï¼Œé€šè¿‡åŒåçš„æ•è·å™¨æ–¹æ³•å°±èƒ½è½»æ¾é‡å»º</li></ul><ul id="fbb4382b-9897-4fdd-aa76-956d6825e502" class="bulleted-list"><li style="list-style-type:disc">å¤„ç†ç¨‹åºå¯¹è±¡ï¼ˆ<code>handler</code>ï¼‰ä¸­çš„æ‰€æœ‰å¯æ•è·çš„æ–¹æ³•éƒ½æœ‰å¯¹åº”çš„<strong>åå°„</strong>ï¼ˆ<strong>Reflect</strong>ï¼‰APIæ–¹æ³•ã€‚è¿™äº›æ–¹æ³•ä¸æ•è·å™¨æ‹¦æˆªçš„æ–¹æ³•å…·æœ‰<strong>ç›¸åŒçš„åç§°å’Œå‡½æ•°ç­¾åï¼Œ</strong>è€Œä¸”ä¹Ÿå…·æœ‰ä¸è¢«æ‹¦æˆªæ–¹æ³•ç›¸åŒçš„è¡Œä¸ºã€‚ä½¿ç”¨åå°„APIå¯ä»¥è½»æ¾é‡å»ºè¢«æ‹¦æˆªæ–¹æ³•çš„åŸå§‹è¡Œä¸º</li></ul><p id="3da0cf2c-8d6f-4dfb-b9ce-4351ce40ebae" class=""><strong>ä¾‹å­</strong></p><pre id="2fcfb826-5fab-4042-855a-539bfe8e91dd" class="code code-wrap"><code>const target = {
  foo: &quot;bar&quot;,
};
const handler = {
  get() {
    return Reflect.get(...arguments);
  },
};
const proxy = new Proxy(target, handler);
console.log(proxy.foo); // bar
console.log(target.foo); // bar</code></pre><ul id="be82eef5-ac62-4fc4-b9e0-846107e1cd92" class="bulleted-list"><li style="list-style-type:disc">ä¸Šé¢çš„ä¾‹å­å®šä¹‰çš„<code>handler.get()</code> æ•è·å™¨ç›´æ¥è¿˜åŸäº†åŸå§‹æ“ä½œç›¸åŒçš„è¡Œä¸ºï¼Œç›¸å½“äºåˆ›å»ºäº†ä¸€ä¸ªç©ºä»£ç†å¯¹è±¡</li></ul><ul id="f2306b96-b9dc-4124-8608-a4ff86de0094" class="bulleted-list"><li style="list-style-type:disc">è¿˜å¯ä»¥å®šä¹‰çš„æ›´ç®€æ´ï¼Œç›´æ¥å°†åå°„çš„<code>get</code> èµ‹å€¼ç»™<code>handler.get</code></li></ul><pre id="354c7626-f9ad-48f0-ae46-3161957753f3" class="code code-wrap"><code>const handler2 = {
  get: Reflect.get,
};
const proxy2 = new Proxy(target, handler2);
console.log(proxy2.foo); // bar
console.log(target.foo); // bar</code></pre><ul id="f59795db-5cf7-490e-8af6-8aca238281fb" class="bulleted-list"><li style="list-style-type:disc">äº‹å®ä¸Šï¼Œå¦‚æœçœŸæƒ³åˆ›å»ºä¸€ä¸ª<strong>æ•è·æ‰€æœ‰æ–¹æ³•ç„¶åå°†æ‰€æœ‰æ–¹æ³•è½¬å‘ç»™å¯¹åº”åå°„API</strong>çš„ç©ºä»£ç†ï¼Œé‚£ä¹ˆç”šè‡³ä¸éœ€è¦å®šä¹‰å¤„ç†ç¨‹åºå¯¹è±¡ï¼Œç›´æ¥æŠŠReflectå†…ç½®å¯¹è±¡ä½œä¸ºå¤„ç†ç¨‹åºå¯¹è±¡ï¼Œå› ä¸ºReflectä¸Šå®šä¹‰äº†å’Œ<code>handler</code>ä¸Šåç§°å®Œå…¨ä¸€æ ·çš„æ–¹æ³•</li></ul><pre id="f59c60dc-c858-4a64-b30b-09489c043cb5" class="code code-wrap"><code>const proxy3 = new Proxy(target, Reflect);
console.log(proxy3.foo); // bar
console.log(target.foo); // bar</code></pre><ul id="9ffbce3f-c0f9-4881-9dbd-d6be78c851c9" class="bulleted-list"><li style="list-style-type:disc">å¯ä»¥åœ¨åå°„APIçš„åŸºç¡€ä¸Šæœ€å°‘çš„ä»£ç ä¿®æ”¹æ•è·çš„æ–¹æ³•ï¼Œå¦‚æœåªæ˜¯å¯¹ä¸€äº›æ“ä½œæœ‰äº›è®¸å¾®è°ƒæ—¶ï¼Œåå°„APIä¼šéå¸¸æœ‰ç”¨</li></ul><pre id="c5c75f4a-ed50-482b-98f3-4e83a784cbf6" class="code code-wrap"><code>const target2 = {
  message1: &quot;hello&quot;,
  message2: &quot;world&quot;,
};
const proxy4 = new Proxy(target2, {
  get(target, prop, receiver) {
    let decoration = &quot;&quot;;
    if (prop === &quot;message1&quot;) {
      decoration = &quot;, world&quot;;
    }
    return Reflect.get(...arguments) + decoration;
  },
});

console.log(proxy4.message1); // hello, world
console.log(target2.message1); // hello</code></pre><ul id="b9c47b5d-7cb7-4609-9058-4ca42faa7113" class="bulleted-list"><li style="list-style-type:disc">é€šè¿‡åˆ¤æ–­<code>prop</code> å¯¹æŒ‡å®šå±æ€§è¿›è¡Œäº†ä¸€ç•ªä¿®é¥°</li></ul><h1 id="23c8ffc0-8f7c-4199-b4d1-0577a5b30fee" class="">1.4 æ•è·å™¨ä¸å˜å¼ï¼ˆtrap invariantï¼‰</h1><ul id="5263fef0-367c-435f-8bc9-f92e64f80aec" class="bulleted-list"><li style="list-style-type:disc">ä»£ç†ä½¿ç”¨æ•è·å™¨å¯ä»¥æ‹¦æˆªå¯¹å¯¹è±¡çš„æ“ä½œç„¶åé‡å®šä¹‰ï¼Œä½†æ˜¯è¿™ç§é‡å®šä¹‰</li></ul><ul id="75d21681-f69a-485a-b307-a27257867cb5" class="bulleted-list"><li style="list-style-type:disc">ECMAScriptè§„èŒƒï¼šæ¯ä¸ªæ•è·æ–¹æ³•éƒ½çŸ¥é“ç›®æ ‡å¯¹è±¡ä¸Šä¸‹æ–‡ã€æ•è·å‡½æ•°ç­¾åï¼Œè€Œæ•è·å¤„ç†ç¨‹åºçš„è¡Œä¸ºå¿…é¡»éµå¾ªâ€<strong>æ•è·ä¸å®šå¼ï¼ˆtrap invariantï¼‰</strong>â€œ</li></ul><ul id="da8ed157-8c98-4f9e-a407-20a81d07b683" class="bulleted-list"><li style="list-style-type:disc">æ•è·å™¨ä¸åŒï¼Œæ¯ä¸ªæ•è·å™¨ä¸å®šå¼ä¹Ÿä¸ç›¸åŒï¼Œä½†éƒ½ä¼šé˜²æ­¢æ•è·å™¨å‡ºç°è¿‡äºåå¸¸çš„è¡Œä¸º</li></ul><ul id="f8d183ee-e15c-4588-9d09-f7924149110e" class="bulleted-list"><li style="list-style-type:disc">ä¾‹å¦‚ç›®æ ‡å¯¹è±¡æœ‰ä¸€ä¸ªä¸å¯é…ç½®ä¸”ä¸å¯å†™çš„æ•°æ®å±æ€§ï¼Œé‚£ä¹ˆ<code>handler.get()</code> éµå¾ªçš„æ•è·å™¨ä¸å®šå¼åº”è¯¥æ˜¯è¿”å›ä¸æ”¹å±æ€§ç›¸åŒçš„å€¼ï¼ˆå› ä¸ºè¯¥æ•°æ®å±æ€§çš„ç‰¹æ€§å†³å®šå€¼ä¸å¯å†æ”¹å˜äº†ï¼Œå¦‚æœè·å–åˆ°çš„æ˜¯ä¸€ä¸ªä¸åŸå§‹æ•°æ®ä¸ç›¸åŒçš„æ•°æ®å€¼ï¼Œæ˜¾ç„¶å±äºå¼‚å¸¸äº†ï¼‰<pre id="1a1ff44a-2684-45cc-8761-041339ecae27" class="code code-wrap"><code>const target = {};
// ä¸å¯é…ç½®ä¸å¯å†™çš„å±æ€§ï¼Œvalueå€¼æ˜¯å›ºå®šçš„
Object.defineProperty(target, &quot;message&quot;, {
  value: &quot;hello, world&quot;,
  configurable: false,
  enumerable: true,
  writable: false,
});
const proxy = new Proxy(target, {
  // æ˜¾ç„¶ä¸éµå¾ªgetçš„æ•è·å™¨ä¸å®šå¼
  get() {
    return &quot;world&quot;;
  },
});

try {
  proxy.message;
} catch (error) {
  console.log(error.toString()); 
//  æ‰“å°å¦‚ä¸‹
TypeError: &#x27;get&#x27; on proxy: property &#x27;message&#x27; is a read-only and non-configurable data property on the proxy target but the proxy did not return its actual value (expected &#x27;hello, world&#x27; but got &#x27;world&#x27;)
}</code></pre></li></ul><h1 id="5ae8a461-4330-4185-a027-4ebc7e5b31b6" class="">1.5 å¯æ’¤é”€ä»£ç†</h1><ul id="c656ff1b-f2eb-4a2a-b0f7-f0b600ca3550" class="bulleted-list"><li style="list-style-type:disc">ä½¿ç”¨<code>new Proxy()</code>åˆ›å»ºçš„ä»£ç†å¯¹è±¡<strong>é»˜è®¤</strong>æ˜¯ä¸å¯æ’¤é”€çš„ï¼Œå³ä»£ç†ä¸å¯¹è±¡ä¹‹é—´çš„è”ç³»åœ¨å£°æ˜å‘¨æœŸå†…ä¸€ç›´å­˜åœ¨</li></ul><ul id="3013c52d-a0bb-4cff-92dd-787866cab19f" class="bulleted-list"><li style="list-style-type:disc">æœ‰æ—¶å€™éœ€è¦ä¸­æ–­ä»£ç†å¯¹è±¡ä¸ç›®æ ‡å¯¹è±¡ä¹‹é—´çš„è”ç³»ï¼Œå°±éœ€è¦åˆ›å»ºä¸€ç§<strong>å¯æ’¤é”€çš„</strong>ï¼ˆ<strong>revocable</strong>ï¼‰ä»£ç†å¯¹è±¡</li></ul><ul id="a4eab721-d813-452d-b9fb-3c00a8fc976c" class="bulleted-list"><li style="list-style-type:disc"><code>Proxy</code> æš´éœ²äº†ä¸€ä¸ªé™æ€æ–¹æ³•<code>Proxy.revocable()</code> ç”¨äºåˆ›å»ºå¯æ’¤é”€çš„ä»£ç†å¯¹è±¡ï¼Œä¸”æ’¤é”€ä»£ç†åçš„æ“ä½œæ—¶ä¸å¯é€†çš„</li></ul><ul id="d537c406-1dd0-4142-9458-836119feb3fd" class="bulleted-list"><li style="list-style-type:disc"><code>Proxy.revocable()</code> è¯­æ³•å¦‚ä¸‹<pre id="5784b60a-9149-489a-ae10-cf84d84ab03d" class="code code-wrap"><code>const { proxy, revoke } = Proxy.revocable(target, handler)</code></pre><ul id="4f99c7c9-f5de-48be-b487-d2ab01f1021b" class="bulleted-list"><li style="list-style-type:circle">å‚æ•°ï¼š<code>target</code>å’Œ<code>handler</code> ä¸<code>Proxy</code> æ„é€ å‡½æ•°çš„å‚æ•°ç›¸åŒï¼Œä½†æ˜¯è°ƒç”¨æ—¶ä¸ä½¿ç”¨<code>new</code> æ“ä½œç¬¦</li></ul><ul id="c89213f4-acbd-423f-8182-fd6205995388" class="bulleted-list"><li style="list-style-type:circle">è¿”å›å€¼ï¼Œä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡åŒ…å«ä¸¤ä¸ªå±æ€§<ul id="c688b120-d21b-45ce-8914-0ac6ae958c8a" class="bulleted-list"><li style="list-style-type:square"><code>proxy</code> :å¯æ’¤é”€çš„ä»£ç†å¯¹è±¡ï¼Œå¦‚æœæ²¡æœ‰æ’¤é”€ï¼Œæœ¬è´¨ä¸Šå’Œæ™®é€šä»£ç†å¯¹è±¡ä¸€æ ·</li></ul><ul id="949ebe1f-922d-4a18-b49a-e965c165962a" class="bulleted-list"><li style="list-style-type:square"><code>revoke</code> : æ’¤é”€å‡½æ•°ï¼Œè°ƒç”¨å’Œï¼Œä¸å®ƒä¸€å¯¹çš„å¯æ’¤é”€ä»£ç†å¯¹è±¡å°±æ’¤é”€äº†ä¸ç›®æ ‡å¯¹è±¡çš„è”ç³»ï¼Œæ’¤é”€å‡½æ•°æ˜¯å¹‚ç­‰çš„ï¼Œè°ƒç”¨å¤šå°‘æ¬¡ç»“æœéƒ½ä¸€æ ·</li></ul></li></ul><ul id="572d7503-fc42-4b4a-954a-421a8e069934" class="bulleted-list"><li style="list-style-type:circle">æ’¤é”€ä»£ç†åå†è°ƒç”¨ä»£ç†ä¼šæŠ›å‡ºTypeErroré”™è¯¯</li></ul></li></ul><p id="a9e6ca3c-da47-4184-9e7e-ca2d1959d8e3" class=""><strong>ä¾‹å­</strong></p><pre id="84832d46-2f5a-4f96-8985-893fe8af683b" class="code"><code>// å¯æ’¤é”€ä»£ç†

const target = {
  foo: &quot;bar&quot;,
};

const handler = {
  get() {
    return &quot;intercepted&quot;;
  },
};

const { proxy, revoke } = Proxy.revocable(target, handler);

console.log(proxy.foo); // intercepted
console.log(target.foo); // bar

// æ’¤é”€ä»£ç†
revoke();

console.log(proxy); // nodeç¯å¢ƒæ‰“å°ä¸º &lt;Revoked Proxy&gt;
try {
  console.log(proxy.message);
} catch (error) {
  console.log(error.message); // Cannot perform &#x27;get&#x27; on a proxy that has been revoked
}</code></pre><ul id="da4db06a-6259-4c51-8fa1-0e55bf9eaa2e" class="bulleted-list"><li style="list-style-type:disc">åœ¨æµè§ˆå™¨ä¸­çš„æ‰“å°å¦‚ä¸‹<figure id="5dd9be5e-8d92-47f7-8025-36fc51ed9384" class="image"><a href="1%20%E4%BB%A3%E7%90%86%E5%9F%BA%E7%A1%80/tianruo_2022-9-23-637995637345424842.png"><img style="width:768px" src="1%20%E4%BB%A3%E7%90%86%E5%9F%BA%E7%A1%80/tianruo_2022-9-23-637995637345424842.png"/></a></figure></li></ul><ul id="21308fb7-46c0-4495-a379-4acd03c3bc90" class="bulleted-list"><li style="list-style-type:disc">å¯ä»¥å‘ç°[[Handler]]å’Œ[[Target]] éƒ½æˆç©ºäº†ï¼Œ[[Isrevoked]]è¢«è®¾ç½®ä¸ºtrueï¼Œè¯´æ˜å¤„ç†ç¨‹åºå¯¹è±¡è¢«æŠ›å¼ƒï¼Œä»£ç†å…³è”çš„æºå¯¹è±¡ä¹Ÿä¸å†ä¿ç•™ï¼ŒProxyä»£ç†å·²ä¸æºå¯¹è±¡æ²¡æœ‰ä»»ä½•å…³ç³»äº†</li></ul><h1 id="212f6fbe-be73-495c-bed1-effe2603b7c1" class="">1.6 MDN-<code>Reflect</code>å†…ç½®å¯¹è±¡æè¿°</h1><figure id="55fdba4d-a312-4965-a375-6ee79b69c8f5" class="link-to-page"><a href="1%20%E4%BB%A3%E7%90%86%E5%9F%BA%E7%A1%80/Reflect.html"><span class="icon">ğŸŒ“</span>Reflect</a></figure><h1 id="48fa6870-7374-402d-8503-344c9e222d9f" class="">1.7 å®ç”¨åå°„APIï¼ˆUtility of the Reflect APIï¼‰</h1><ul id="45e4dd7d-0a1b-4709-817d-0ad579b05d52" class="bulleted-list"><li style="list-style-type:disc"><a href="1%20%E4%BB%A3%E7%90%86%E5%9F%BA%E7%A1%80/Reflect.html">1.6 å°ç»“</a>ä»‹ç»äº†<code>Reflect</code> ä¸­æ‰€æœ‰çš„é™æ€æ–¹æ³•ä»¥åŠå®ƒåœ¨<strong>Object</strong>ä¸­å­˜åœ¨çš„å¯¹åº”åŒåçš„é™æ€æ–¹æ³•</li></ul><ul id="a2dd0a9f-ae23-4f56-9f11-d65a58bd6d38" class="bulleted-list"><li style="list-style-type:disc">æŸäº›æƒ…å†µä¸‹ï¼Œåº”è¯¥ä¼˜å…ˆä½¿ç”¨åå°„APIï¼ˆReflectçš„é™æ€æ–¹æ³•ï¼‰ï¼ŒåŸå› å¦‚ä¸‹</li></ul><h2 id="c2a6fde3-a9bc-4f75-9804-dc91e43da969" class="">1.7.1 åå°„APIä¸å¯¹è±¡APIï¼ˆReflect API and Object APIï¼‰</h2><p id="4d71f379-c001-4e00-b797-6e1b4a4a4d7d" class=""><strong>æ·±å…¥</strong>ç†è§£ï¼ˆ<strong>diving into</strong>ï¼‰åå°„APIéœ€è¦è®°ä½çš„ä¸¤ä¸ªç‚¹</p><ol type="1" id="ed36cea5-d5e9-4a9f-985a-770863437c85" class="numbered-list" start="1"><li>åå°„APIå¹¶ä¸é™äºæ•è·å¤„ç†ç¨‹åº</li></ol><ol type="1" id="66bfb9b1-e18b-49b5-9106-183b08f4bc80" class="numbered-list" start="2"><li>å¤§å¤šæ•°åå°„APIæ–¹æ³•åœ¨<code>Object</code>ç±»å‹ä¸Šæœ‰<strong>ç›¸ä¼¼</strong>çš„æ–¹æ³•ï¼ˆ<strong>analogue</strong>ï¼‰</li></ol><p id="dcadaa55-e709-4431-bfc5-d1d47dfc8176" class="">é€šå¸¸ï¼ŒObjectä¸Šçš„æ–¹æ³•é€‚ç”¨äºé€šç”¨ç¨‹åºï¼Œè€Œ<strong>åå°„æ–¹æ³•é€‚ç”¨äºç»†ç²’åº¦ï¼ˆfine-tunedï¼‰çš„å¯¹è±¡æ§åˆ¶ä¸æ“ä½œï¼ˆmanipulationï¼‰</strong></p><h2 id="52f2d9f9-8917-4f53-8ad1-cf2c908cda15" class="">1.7.2 çŠ¶æ€æ ‡è®°</h2><ul id="18ae8d81-c1c4-4b62-9db1-7d6f69239379" class="bulleted-list"><li style="list-style-type:disc">åœ¨1.6 ä¸­é˜è¿°åå°„APIä¸å¯¹è±¡APIçš„ä¸åŒæ—¶ï¼Œä¸€ä¸ªå…³é”®ä¸åŒå°±æ˜¯åŠŸèƒ½ç›¸åŒçš„é™æ€æ–¹æ³•ï¼Œ<strong>è¿”å›å€¼ä¸åŒ</strong></li></ul><ul id="d0f4ed6e-3dc2-45ee-8af1-b2626d5c7da7" class="bulleted-list"><li style="list-style-type:disc">å¾ˆå¤šåå°„æ–¹æ³•è¿”å›ç§°ä½œâ€œ<strong>çŠ¶æ€æ ‡è®°ï¼ˆstatus flagï¼‰</strong>â€çš„å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ„å›¾æ‰§è¡Œçš„æ“ä½œæ˜¯å¦æˆåŠŸï¼Œè¿™æ¯”æœ‰äº›è¿”å›ä¿®æ”¹åçš„ç›®æ ‡å¯¹è±¡çš„Objecté™æ€æ–¹æ³•æˆ–æŠ›å‡ºé”™è¯¯çš„æ–¹æ³•æ›´æœ‰ç”¨å¤„</li></ul><ul id="f85b0eb5-f588-41d1-a10f-fd2243347ebf" class="bulleted-list"><li style="list-style-type:disc">å¦‚ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨Object APIå®šä¹‰å±æ€§çš„ä¾‹å­<pre id="d79a3a91-8da6-4955-8e0d-b80edff47e32" class="code"><code>const o = {};
try {
  Object.defineProperty(o, &quot;foo&quot;, {
    value: &quot;bar&quot;,
  });
  console.log(&quot;success&quot;);
} catch (error) {
  console.log(&quot;failure&quot;);
}</code></pre><ul id="4386a27a-6308-446b-abf0-bb13caf2bff1" class="bulleted-list"><li style="list-style-type:circle">ä¸Šé¢ç®€å•å±•ç¤ºæ˜¾ç„¶ä¸ä¼šæŠ›å‡ºé”™è¯¯ï¼Œä½†æ˜¯åœ¨<a href="../8%20%E5%AF%B9%E8%B1%A1%E3%80%81%E7%B1%BB%E4%B8%8E%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B/1%20%E7%90%86%E8%A7%A3%E5%AF%B9%E8%B1%A1.html"><code>Object.defineProperty()</code></a> ä¸­ï¼Œå¦‚æœå®šä¹‰æ—¶å‘ç”Ÿé—®é¢˜ï¼Œæ˜¾ç„¶ä¼šæŠ›å‡ºé”™è¯¯è€Œä¸æ˜¯è¿”å›false</li></ul></li></ul><ul id="22947fcb-8eac-444d-a0bd-ae029c594e19" class="bulleted-list"><li style="list-style-type:disc">ä½¿ç”¨<code>Reflect.defineProperty()</code> å¯ä»¥é‡æ„ä¸Šé¢çš„ä»£ç ï¼Œåœ¨ä¿è¯ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¯¹è±¡çš„æƒ…å†µä¸‹ï¼Œå®ƒä¸ä¼šæŠ›å‡ºé”™è¯¯ï¼Œåè€Œå› ä¸ºè¿”å›å€¼å¯ä»¥ç»™å‡ºçŠ¶æ€æ ‡è®°æ›´ä¾¿äºç¼–å†™ç¨‹åº<pre id="5b00b1e6-8f6c-4970-8aaa-f953eb48c58c" class="code"><code>const o = {};
if (
  Reflect.defineProperty(o, &quot;foo&quot;, {
    value: &quot;bar&quot;,
  })
) {
  console.log(&quot;success&quot;);
} else {
  console.log(&quot;failure&quot;);
}</code></pre></li></ul><ul id="7cdb783a-7668-44bf-bbb8-ee58a61e95c3" class="bulleted-list"><li style="list-style-type:disc">ä»¥ä¸‹åå°„æ–¹æ³•éƒ½ä¼šæä¾›çŠ¶æ€æ ‡è®°<ul id="188e0ff7-c5db-4696-886a-32e02ca0c0fb" class="bulleted-list"><li style="list-style-type:circle"><code>Reflect.defineProperty()</code></li></ul><ul id="1abf8646-80e9-4a12-8bdb-cd37c65a5148" class="bulleted-list"><li style="list-style-type:circle"><code>Reflect.preventExtensible()</code></li></ul><ul id="f5cad340-3637-480a-8c2e-285701d65eb9" class="bulleted-list"><li style="list-style-type:circle"><code>Reflect.setPrototypeOf()</code></li></ul><ul id="5ecf3a99-06bf-41e8-ad92-4dccc257d4a3" class="bulleted-list"><li style="list-style-type:circle"><code>Reflect.set()</code></li></ul><ul id="a831f1b6-0f15-49fb-8e60-26878a1a8b4d" class="bulleted-list"><li style="list-style-type:circle"><code>Reflect.deletePrototype()</code></li></ul><ul id="b00b7432-7c60-48dd-aa72-cfc00b9ac23d" class="bulleted-list"><li style="list-style-type:circle">è¯¦ç»†ä»‹ç»å¯ä»¥æŸ¥çœ‹<a href="1%20%E4%BB%A3%E7%90%86%E5%9F%BA%E7%A1%80/Reflect.html"><span class="icon">ğŸŒ“</span>Reflect</a> </li></ul></li></ul><h2 id="b807187a-af5c-4681-8b16-4a709f76ee28" class="">1.7.3 ç”¨ä¸€ç­‰å‡½æ•°æ›¿ä»£æ“ä½œç¬¦ï¼ˆSupplanting Operators with First-Class Functionsï¼‰</h2><ul id="500ab206-b1c2-4028-997a-1c16bc8c1188" class="bulleted-list"><li style="list-style-type:disc">Supplanting å³æ›¿ä»£ï¼ŒFirst-Class è¡¨ç¤ºä¼˜ç§€ï¼ŒReflectçš„ä¸€äº›é™æ€æ–¹æ³•æ‹¥æœ‰å’Œä¸€äº›æ“ä½œç¬¦ç›¸åŒçš„åŠŸèƒ½ï¼Œå¦‚ä¸‹<ul id="d2c26268-cc2a-4c9e-92be-b8eef3553f06" class="bulleted-list"><li style="list-style-type:circle"><code>Reflect.get()</code>: å¯ä»¥æ›¿ä»£å¯¹è±¡å±æ€§è®¿é—®æ“ä½œç¬¦</li></ul><ul id="ebf6686d-766d-4174-a50a-731ca6d61f72" class="bulleted-list"><li style="list-style-type:circle"><code>Reflect.set()</code>: å¯ä»¥æ›¿ä»£<code>=</code>èµ‹å€¼æ“ä½œç¬¦ï¼ˆassignment operatorï¼‰</li></ul><ul id="3d1f8af7-ec00-435e-8c5d-dfc86f5647dd" class="bulleted-list"><li style="list-style-type:circle"><code>Reflect.has()</code> : å¯ä»¥æ›¿ä»£<code>in</code> æ“ä½œç¬¦æˆ–<code>with()</code></li></ul><ul id="9da21f02-deec-4654-b510-a9014583be92" class="bulleted-list"><li style="list-style-type:circle"><code>Reflect.deleteProperty()</code> :å¯ä»¥æ›¿ä»£<code>delete</code>æ“ä½œç¬¦</li></ul><ul id="49bdaea1-1074-4400-b126-0fd68f7cab2e" class="bulleted-list"><li style="list-style-type:circle"><code>Reflect.construct()</code> :å¯ä»¥æ›¿ä»£<code>new</code>æ“ä½œç¬¦</li></ul></li></ul><h2 id="b80f12ea-8783-4f85-a463-ca5415e7d72a" class="">1.7.4 å®‰å…¨åœ°åº”ç”¨å‡½æ•°</h2><ul id="d214f4c4-3971-448d-9cbd-36cd8c14d51b" class="bulleted-list"><li style="list-style-type:disc">å‡½æ•°ä½œä¸ºä¸€ä¸ªå¯¹è±¡å¯ä»¥é€šè¿‡<code>apply</code> æ–¹æ³•è¿›è¡Œè°ƒç”¨ï¼Œæ–¹ä¾¿æŒ‡å®š<code>this</code></li></ul><ul id="8be4811f-7f19-4123-8652-d843e2de88ee" class="bulleted-list"><li style="list-style-type:disc">ä½†æ˜¯è¢«è°ƒç”¨åœ°å‡½æ•°å¯èƒ½å®šä¹‰äº†è‡ªå·±çš„<code>apply</code>å±æ€§ ï¼ˆå¯èƒ½æ€§æå°ï¼‰ï¼Œè¿™æ ·å°±ä¸èƒ½ä½¿ç”¨åŸå‹ä¸Šçš„<code>apply</code>æ–¹æ³•äº†</li></ul><ul id="7cba4306-6ce7-4b46-ab14-330a07eb9424" class="bulleted-list"><li style="list-style-type:disc">ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨å®šä¹‰åœ¨FunctionåŸå‹ï¼ˆprototypeï¼‰ä¸Šçš„<code>apply</code>æ–¹æ³• ï¼Œæ¯”å¦‚<pre id="6edcf322-1cc4-4e87-9243-8bbf0cf70af9" class="code"><code>// å®‰å…¨åº”ç”¨å‡½æ•°
function foo() {
  console.log(&quot;foo&quot;);
}
foo.apply();
// è‡ªå®šä¹‰applyå¯¼è‡´è°ƒç”¨æ—¶äº§ç”Ÿé—®é¢˜
foo.apply = function (thisArg, ...rest) {
  console.log(&quot;bar&quot;);
};
foo.apply();

// ä½¿ç”¨FunctionåŸå‹ä¸Šçš„applyæ–¹æ³•
Function.prototype.apply.call(foo);</code></pre></li></ul><ul id="fcda2e60-56f9-4e4e-84e0-f30b5faa8a56" class="bulleted-list"><li style="list-style-type:disc">ä½†æ˜¯ä»£ç è¿‡é•¿ï¼Œè¿˜éœ€è¦è°ƒç”¨applyçš„callæ–¹æ³•ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨<code>Reflect.apply()</code>æ¥é¿å…<pre id="51d356e6-473f-41d3-8221-e16d0e63bffb" class="code"><code>// ä½†æ˜¯è¿™å¤ªéº»çƒ¦äº†ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨Reflectçš„API
Reflect.apply(foo, null, []);</code></pre><ul id="c247ac73-c7dd-457f-a9d3-66d95dcbb5f2" class="bulleted-list"><li style="list-style-type:circle">å”¯ä¸€ç¼ºç‚¹æ˜¯è¢«è°ƒç”¨å‡½æ•°å‚æ•°ä¸ºç©ºä¹Ÿè¦ä¿è¯ä¼ é€’ç©ºå‚æ•°æ•°ç»„è¿‡å»</li></ul></li></ul><h1 id="4d0a5957-7052-48ad-8144-09ffd8f6e48c" class="">1.8 ä»£ç†å¦ä¸€ä¸ªä»£ç†(Proxying a Proxy)</h1><ul id="87189b11-fcbb-42ee-8b1c-735f18a1f891" class="bulleted-list"><li style="list-style-type:disc">ä»£ç†å¯ä»¥æ‹¦æˆªï¼ˆinterceptingï¼‰åå°„APIçš„æ“ä½œï¼Œè¿™æ„å‘³ç€å®Œå…¨å¯ä»¥åˆ›å»ºä¸€ä¸ªä»£ç†ï¼Œé€šè¿‡å®ƒå»ä»£ç†å¦å¤–ä¸€ä¸ªä»£ç†</li></ul><ul id="3b90012a-91f2-46c1-984f-343ecfc9d70c" class="bulleted-list"><li style="list-style-type:disc">è¿™æ ·å°±å¯ä»¥åœ¨å•ä¸ªç›®æ ‡å¯¹è±¡ä¸Šæ„å»ºå¤šå±‚æ‹¦æˆªç½‘ï¼ˆmultiple layers of <strong>indirection</strong>ï¼‰<ul id="94431645-fcf1-4ffa-94ac-33d790043321" class="bulleted-list"><li style="list-style-type:circle"><strong>indirection:</strong>é—´æ¥<strong>ï¼Œ</strong>è¡¨ç¤ºé€šè¿‡ä»£ç†ä¸€ä¸ªä»£ç†äº†ç›®æ ‡å¯¹è±¡çš„ä»£ç†ä»è€Œé—´æ¥ä»£ç†ç›®æ ‡å¯¹è±¡</li></ul></li></ul><pre id="78486cea-7684-41ed-bb97-f1657b5d2464" class="code"><code>const target = { foo: &quot;bar&quot; };

const firstProxy = new Proxy(target, {
  get() {
    console.log(&quot;frist proxy&quot;);
    return Reflect.get(...arguments);
  },
});

const secondProxy = new Proxy(firstProxy, {
  get() {
    console.log(&quot;second proxy&quot;);
    return Reflect.get(...arguments);
  },
});

console.log(secondProxy.foo);
// second proxy
// frist proxy
// bar
console.log(firstProxy.foo);
// frist proxy
// bar</code></pre><ul id="8ed08216-6933-41e8-91c5-ec3458b05547" class="bulleted-list"><li style="list-style-type:disc">åœ¨æ‰§è¡Œ<code>secondProxy.foo</code>æ—¶ï¼Œå®ƒä¼šæ‹¦æˆª<code>firstProxy</code>çš„<code>get</code>æ“ä½œï¼Œç„¶åæ‰§è¡Œ<code>secondProxy</code>è‡ªå·±çš„<code>get</code>æ“ä½œæ‰“å°å‡º<code>&quot;second proxy&quot;</code>  ,æ­¤æ—¶å®ƒçš„<code>arguments</code> å‚æ•°ä¸­æ˜¯ <code>(firstProxy, &quot;foo&quot;, secondProxy)</code></li></ul><ul id="5fd94834-1557-4450-946c-8e894166a82a" class="bulleted-list"><li style="list-style-type:disc">ç„¶åå†æ‰§è¡Œ<code>Reflect.(firstProxy, &quot;foo&quot;, secondProxy)</code> ï¼Œç›¸å½“äºè·å–<code>firstProxy.foo</code> ï¼Œå®ƒä¼šæ‹¦æˆª<code>target</code> çš„<code>get</code>æ“ä½œï¼Œç„¶åæ‰§è¡Œ<code>firstProxy</code> è‡ªå·±çš„<code>get</code>æ“ä½œæ‰“å°å‡º<code>&quot;first proxy&quot;</code> ï¼Œæœ€åæ‰§è¡Œ<code>Reflect.get(target, &quot;foo&quot;, firstProxy)</code> è·å–åˆ°ç›®æ ‡å¯¹è±¡ä¸­çš„å€¼</li></ul><h1 id="7774fc50-02d2-4720-94b3-19271309dd6f" class="">1.9 ä»£ç†çš„é—®é¢˜ä¸ä¸è¶³ï¼ˆConsiderations and Shortcomingsï¼‰</h1><p id="aec94e84-22ba-49f2-bed2-fd58824228c2" class="">ä»£ç†æ˜¯åœ¨ECMAScriptç°æœ‰<strong>åŸºç¡€</strong>ï¼ˆ<strong>infrastructure</strong>ï¼‰ä¸Šæ„å»ºèµ·æ¥çš„ä¸€å¥—æ–°APIï¼Œå…¶å®å·²ç»å°½åŠ›åšåˆ°å¾ˆå¥½äº†ï¼Œä»£ç†ä½œä¸ºå¯¹è±¡çš„è™šæ‹Ÿå±‚ï¼ˆvirtualization layerï¼‰å¯ä»¥æ­£å¸¸ä½¿ç”¨</p><p id="535064f2-d85c-462a-a65a-3ec4db0d06cd" class="">ä½†æ˜¯åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œä»£ç†ä¸èƒ½ä¸ç°æœ‰çš„ECMAScript<strong>æ„é€ </strong>ï¼ˆ<strong>constructs</strong>ï¼‰è¿›è¡Œå¾ˆå¥½çš„<strong>ååŒ</strong>ï¼ˆ<strong>integrate</strong>ï¼‰</p><h2 id="31ae0846-b2dc-4167-adb6-6f2793a4be34" class="">1.9.1 ä»£ç†ä¸­çš„this</h2><ul id="ce730c25-b199-46f2-81e0-01561f179495" class="bulleted-list"><li style="list-style-type:disc">ä»£ç†æ½œåœ¨çš„ä¸€ä¸ªé—®é¢˜æ¥æºæ˜¯<code>this</code>å€¼</li></ul><ul id="6990f169-0a3f-43e5-8917-ad56c2c3249b" class="bulleted-list"><li style="list-style-type:disc">ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ–¹æ³•ä¸­çš„<code>this</code> æŒ‡è°ƒç”¨è¿™ä¸ªæ–¹æ³•çš„å¯¹è±¡ï¼Œå¦‚ä¸‹<pre id="f71228b2-a9f8-4888-8528-4b9567544277" class="code"><code>const target = {
  thisValEqualProxy() {
    return this === proxy;
  },
};
const proxy = new Proxy(target, {});
console.log(target.thisValEqualProxy()); // false
console.log(proxy.thisValEqualProxy()); // true</code></pre><ul id="b73d52c3-27ea-4be1-a1c8-313df44e9261" class="bulleted-list"><li style="list-style-type:circle">é€šè¿‡<code>proxy</code>è°ƒç”¨æ–¹æ³•ï¼Œé‚£ä¹ˆæ–¹æ³•ä¸­çš„<code>this</code>å°±æ˜¯<code>proxy</code> å¯¹è±¡ï¼Œè¿”å›<code>true</code></li></ul><ul id="9fd48ea6-6654-4a81-888c-cc551d504060" class="bulleted-list"><li style="list-style-type:circle">é€šè¿‡<code>target</code> è°ƒç”¨æ–¹æ³•ï¼Œé‚£ä¹ˆæ–¹æ³•ä¸­çš„<code>this</code> å°±æ˜¯<code>target</code>å¯¹è±¡ï¼Œè¿”å›<code>false</code></li></ul></li></ul><ul id="8459d22a-4c81-4561-a269-c82c9babca93" class="bulleted-list"><li style="list-style-type:disc">æ‰€ä»¥ä»ç›´è§‰ä¸Šæ¥æ‰€ï¼Œè¿™æ ·åœ¨ä»£ç†è°ƒç”¨æ—¶å°†æ–¹æ³•çš„<code>this</code>è®¾ç½®ä¸ºä»£ç†å¯¹è±¡æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼š<ul id="46873845-8bca-49ed-adb8-4af513cda8eb" class="bulleted-list"><li style="list-style-type:circle">è°ƒç”¨<code>proxy.outerMethod()</code> <code>this</code>æŒ‡è¢«æŒ‡å‘ä¸º<code>proxy</code></li></ul><ul id="61e1a047-5da0-4625-b8ae-d488ed72b172" class="bulleted-list"><li style="list-style-type:circle">è€Œè¿™ä¸ªæ–¹æ³•åˆä¼šè°ƒç”¨å¦å¤–ä¸€ä¸ªæ–¹æ³•ï¼Œå¦‚<code>this.innerMethod()</code> ï¼Œå› ä¸º<code>this</code> æŒ‡å‘<code>proxy</code> çš„ç¼˜æ•…ï¼Œä¼šè°ƒç”¨<code>proxy.innerMethod()</code> å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™æ˜¯ç¬¦åˆé¢„æœŸçš„</li></ul><ul id="c8ec362d-75b4-4959-9976-df033849b3e5" class="bulleted-list"><li style="list-style-type:circle"><del><span style="border-bottom:0.05em solid">è¿™æ ·ä¿è¯</span></del><del><span style="border-bottom:0.05em solid"><code>this</code></span></del><del><span style="border-bottom:0.05em solid">å€¼ç»Ÿä¸€ï¼Œå¦‚æœä½¿ç”¨proxyè°ƒç”¨æ–¹æ³•thisè¢«æŒ‡ä»£</span></del><del><span style="border-bottom:0.05em solid"><code>target</code></span></del><del><span style="border-bottom:0.05em solid"> ,è¿™ä¼šå¯¼è‡´æ–¹æ³•å†…å¯¹targetçš„å…¶ä»–å±æ€§è°ƒç”¨ä¸ç»è¿‡ä»£ç†ï¼Œè€Œæ˜¯ç›´æ¥é€šè¿‡targetè®¿é—®ï¼Œè¿™ä¸ç¬¦åˆä»£ç†åº•å±‚çš„å®ç°æ„ä¹‰</span></del></li></ul></li></ul><ul id="788383dd-3cff-44fe-93fe-5d3b7f09004f" class="bulleted-list"><li style="list-style-type:disc">å¦‚æœç›®æ ‡å¯¹è±¡ä¾èµ–äºå¯¹è±¡æ ‡è¯†ï¼ˆobject identityï¼‰ï¼Œå°±ä¼šç¢°åˆ°æ„æ–™ä¹‹å¤–çš„é—®é¢˜</li></ul><ul id="051749ba-0871-4bca-b067-e1ad60784edd" class="bulleted-list"><li style="list-style-type:disc">ä¸€ä¸ªå…¸å‹çš„éœ€è¦ä¾èµ–å¯¹è±¡æ ‡è¯†çš„åœºæ™¯æ˜¯ï¼šä½¿ç”¨WeakMapä¿å­˜ç§æœ‰å˜é‡ï¼Œå¦‚ä¸‹<pre id="0f068017-9e10-4ac4-acd1-67443631443e" class="code"><code>let Person;
{
  const privateScope = new WeakMap();
  Person = function (name, id) {
    this.name = name;
    this.setIDNum(id);
  };
  Person.prototype.getIDNum = function () {
    return privateScope.get(this)[&quot;id&quot;];
  };
  Person.prototype.setIDNum = function (val) {
    const privateMembers = privateScope.get(this) || {};
    privateMembers[&quot;id&quot;] = val;
    privateScope.set(this, privateMembers);
  };
}
console.log(typeof privateScope); // undefined 

const person = new Person(&quot;mangwu&quot;, &quot;421023yyyymmdd1234&quot;);
console.log(person); // PersonÂ {name: &#x27;mangwu&#x27;}
// å…¬å…±å±æ€§å¯ä»¥ç›´æ¥å¥ç‚¹è°ƒç”¨ä¿®æ”¹
person.name = &quot;wumang&quot;;
person.setIDNum(&quot;421023yyyymmdd4567&quot;);
console.log(person.getIDNum()); // 421023yyyymmdd4567</code></pre><ul id="e6624e59-0788-4a33-94ed-009d1478ff57" class="bulleted-list"><li style="list-style-type:circle">è¿™ä¸ªä¾‹å­ä¸­æ˜¯é€šè¿‡<code>WeakMap</code>è®°å½•æ¯ä¸ª<code>Person</code>å®ä¾‹çš„<code>id</code>çš„ï¼Œè€Œ<strong>è®°å½•ä¾èµ–Personå®ä¾‹çš„å¯¹è±¡æ ‡è¯†ï¼Œ</strong>å³<code>privateScope.set(this, privateMembers);</code> å’Œ<code>return privateScope.get(this)[&quot;id&quot;];</code> æ—¶ï¼Œ<code>this</code> çš„å€¼éœ€è¦å›ºå®šä¸‹æ¥ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´ä»£ç†å’Œ<code>target</code>å®ä¾‹æ‹¥æœ‰ä¸åŒçš„<code>id</code> ï¼Œå¦‚ä¸‹</li></ul><pre id="4f0c0af0-d944-428c-8f82-588cd82f578b" class="code"><code>const proxyPerson = new Proxy(person, {});
try {
  console.log(proxyPerson.getIDNum()); // å› ä¸ºthisæŒ‡å‘proxyæœ¬èº«ï¼Œæ‰€ä»¥ä¸å­˜åœ¨id
} catch (error) {
  // æŠ¥é”™åŸå› æ˜¯privateScope.get(this)çš„ç»“æœæ˜¯undefinedï¼Œå†è®¿é—®å…¶ä¸­çš„idå¿…ç„¶å‡ºé”™
  console.log(error.toString()); // TypeError: Cannot read properties of undefined (reading &#x27;id&#x27;)
}
proxyPerson.setIDNum(&quot;321421yyyymmdd1234&quot;); // å› ä¸ºthisæŒ‡å‘proxyæœ¬èº«ç›¸å½“äºå†wmæ·»åŠ äº†ä¸€ä¸ªæ–°id
console.log(proxyPerson.getIDNum()); // è¿™ä¸ªidæ˜¯proxyåˆå†wmä¸­ä½œä¸ºé”®æ–°å»ºçš„id 321421yyyymmdd1234
console.log(person.getIDNum()); // å®ä¾‹æœ¬èº«çš„idå…¶å®å¹¶æ²¡æœ‰æ”¹å˜ 421023yyyymmdd4567</code></pre><ul id="bb3ee5c6-09ea-41ac-8667-8d65149de393" class="bulleted-list"><li style="list-style-type:circle">å› ä¸ºè¿™ç§ç§æœ‰å±æ€§çš„<strong>å®ç°</strong>ï¼ˆ<strong>implementation</strong>ï¼‰ä¸€å¼€å§‹å°±ä¾èµ–äºPersonå®ä¾‹çš„<strong>å¯¹è±¡æ ‡è¯†</strong>ï¼ˆ<strong>object identity</strong>ï¼‰ï¼Œå½“Personå¯¹è±¡å®ä¾‹è¢«ä»£ç†åå¿…ç„¶å‡ºç°è¿™ç§æƒ…å†µï¼›åœ¨å¯¹è±¡ä»£ç†è§†å›¾é€šè¿‡ä»£ç†<strong>æœ¬èº«</strong>ï¼ˆproxy objectï¼‰<strong>æ£€ç´¢ï¼ˆretrieveï¼‰</strong>idæ—¶ï¼Œ wmä¸­åªæœ‰è¢«åˆå§‹åŒ–ä¸ºPersonå®ä¾‹çš„keyå€¼ï¼Œå¿…ç„¶è¿”å›undefinedæˆ–æŠ›å‡ºé”™è¯¯</li></ul><ul id="754dabc2-2041-46ae-a2da-2ba2ba7c9c65" class="bulleted-list"><li style="list-style-type:circle">è§£å†³æ–¹æ³•æ˜¯ï¼š<strong>é‡å†™é…ç½®</strong>ï¼ˆ<strong>reconfigure</strong>ï¼‰ä»£ç†ï¼ŒæŠŠ<code>WeakMap</code> ä¸­çš„<code>key</code> æ’å…¥ï¼ˆinsertionï¼‰çš„åˆå§‹åŒ–è®¾ç½®ä¸ºä»£ç†å®ä¾‹â€”é€šè¿‡ä»£ç†æ„é€ å‡½æ•°ï¼ˆç±»ï¼‰æœ¬èº«ï¼Œç„¶åå®ä¾‹åŒ–ï¼ˆinstantiatingï¼‰ä»£ç†çš„æ„é€ å‡½æ•°ï¼ˆç±»ï¼‰ï¼›è¿™æ ·ä¿è¯äº†å®ä¾‹åŒ–æ—¶çš„<code>this</code> æ˜¯ä»£ç†å®ä¾‹è€Œä¸æ˜¯ç›®æ ‡å¯¹è±¡</li></ul><pre id="d221b79d-75c2-46d1-b5e9-70dbf740c4f6" class="code"><code>// è§£å†³æ–¹æ³•ï¼Œç›´æ¥ä»£ç†æ„é€ å‡½æ•°
const PersonProxy = new Proxy(Person, {});
const proxyPerson2 = new PersonProxy(&quot;mangwu&quot;, &quot;321421yyyymmdd1234&quot;);
console.log(proxyPerson2); // Person { name: &#x27;mangwu&#x27; }
console.log(proxyPerson2.getIDNum()); // 321421yyyymmdd1234</code></pre></li></ul><h2 id="ba0bb84d-363c-411c-94ad-c588271b8008" class="">1.9.2 ä»£ç†ä¸å†…éƒ¨æ§½ä½ï¼ˆInternal Slotsï¼‰</h2><ul id="74ac3994-a69b-43c1-a6b7-05a81987e1cf" class="bulleted-list"><li style="list-style-type:disc">å…³äº<strong>å†…éƒ¨æ§½ä½ï¼ˆInternal Slotsï¼‰</strong><ul id="36b91d13-78d6-466b-8744-4a1237cb286d" class="bulleted-list"><li style="list-style-type:circle">æœ‰äº›åœ°æ–¹ç¿»è¯‘ä¸º<strong>å†…éƒ¨æ’æ§½</strong>ï¼ˆæ›´åˆé€‚ï¼‰ï¼Œåœ¨å¯¹è±¡çš„åŸå‹å­¦ä¹ ä¸­å·²ç»æ¥è§¦è¿‡äº†ï¼Œå°±æ˜¯æ¯ä¸ªå¯¹è±¡ï¼ˆ<strong>ordinary object</strong> æ™®é€šå¯¹è±¡ä¸åŒ…æ‹¬ç‰¹æ®Šçš„ï¼‰éƒ½æœ‰ä¸€ä¸ªåä¸º[[Prototype]]çš„<strong>å†…éƒ¨æ’æ§½</strong>ï¼Œåœ¨JavaScriptä¸­ç†è§£ä¸ºå¯¹è±¡çš„åŸå‹å¯¹è±¡</li></ul><ul id="c4c48639-2ff0-4345-8dde-b0331a03f775" class="bulleted-list"><li style="list-style-type:circle">é™¤æ­¤ä¹‹å¤–è¿˜æœ‰ä¸€ä¸ªå¸¸è§çš„<strong>å†…éƒ¨æ’æ§½</strong>ï¼Œåœ¨ä»‹ç»<code>Reflect.isExtensible()</code> æ—¶ä¹Ÿæåˆ°è¿‡ï¼Œå°±æ˜¯[[Extensible]]å†…å­˜æ’æ§½ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œç”¨äºå®ç°ä¸å¯æ‰©å±•æ€§ç›¸å…³çš„å†…éƒ¨æ–¹æ³•</li></ul><ul id="d3c160b3-4c98-4d12-99d7-a484e896b428" class="bulleted-list"><li style="list-style-type:circle"><strong>å†…éƒ¨æ’æ§½æ˜¯ESè§„èŒƒå†…éƒ¨å®šä¹‰çš„ä¸€ç³»åˆ—ä¼ªå±æ€§ï¼ˆpseudo-propertyï¼‰ï¼Œæ— æ³•é€šè¿‡jsè®¿é—®åˆ°ï¼Œåªèƒ½ä½œä¸ºå¼•æ“è¿è¡ŒJSä»£ç æ—¶çš„å†…éƒ¨å±æ€§è€Œå­˜åœ¨ã€‚å†…éƒ¨æ’æ§½ä½œä¸ºä¸€ç§ä¼ªå±æ€§è®°å½•çš„æ˜¯æ•°æ®/çŠ¶æ€ï¼Œè€Œä¸æ˜¯è®°å½•çš„æ–¹æ³•ï¼Œä¼ªå±æ€§çš„æ–¹æ³•è®°å½•åœ¨å†…éƒ¨æ–¹æ³•ä¸­ã€‚åœ¨è§„èŒƒä¸­ï¼Œç”¨[[]]åŒé‡ç¬¦å·åŒ…è£¹èµ·æ¥çš„å°±æ˜¯å†…éƒ¨æ’æ§½/æ–¹æ³•</strong></li></ul><ul id="baee882b-7b86-415a-b9d5-53e43568b1a4" class="bulleted-list"><li style="list-style-type:circle">æƒ³è¦ç†è§£å†…éƒ¨æ’æ§½ï¼Œå¯ä»¥è¯»TC39å…³äºESçš„<a href="https://tc39.es/">è§„èŒƒ</a>ï¼Œ ä¹Ÿå¯ä»¥äº†è§£V8å¼•æ“å¯¹äºECMAScriptå®ç°è®°å½•çš„<a href="https://v8.dev/blog/understanding-ecmascript-part-1">åšå®¢</a></li></ul></li></ul><ul id="97ebe7e0-759f-4582-aa13-bb9d2811f605" class="bulleted-list"><li style="list-style-type:disc">ä»£ç†å’Œå†…ç½®å¼•ç”¨ç±»å‹ï¼ˆå¦‚Arrayï¼‰çš„å®ä¾‹é€šå¸¸å¯ä»¥å¾ˆå¥½çš„ååŒï¼Œä½†æ˜¯æœ‰äº›ECMAScriptå†…ç½®ç±»å‹å¯èƒ½ä¼šä¾èµ–ä»£ç†æ— æ³•æ§åˆ¶çš„<strong>æœºåˆ¶</strong>ï¼ˆ<strong>mechanisms</strong>ï¼‰ï¼Œç»“æœå¯¼è‡´åœ¨ä»£ç†ä¸Šè°ƒç”¨æŸäº›æ–¹æ³•ä¼šå‡ºé”™</li></ul><ul id="fb5a442e-96af-49fa-9cae-8937aaed70dd" class="bulleted-list"><li style="list-style-type:disc">ä¸€ä¸ªå…¸å‹çš„ä¾‹å­å°±æ˜¯<code>Date</code>ç±»å‹<ul id="2b530f4f-63ee-4ebb-88ec-e488213a88db" class="bulleted-list"><li style="list-style-type:circle">ECMAScriptè§„èŒƒï¼Œ<code>Date</code>ç±»å‹æ–¹æ³•æ‰§è¡Œä¾èµ–<code>this</code>å€¼ä¸Šçš„<strong>å†…éƒ¨æ§½ä½</strong>[[NumberDate]]</li></ul><ul id="3fb00edf-1edc-4278-8c17-1a0340358ff4" class="bulleted-list"><li style="list-style-type:circle">ä»£ç†äº†ä¸€ä¸ª<code>Date</code> å®ä¾‹çš„ä»£ç†å¯¹è±¡ä¸Š<strong>ä¸å­˜åœ¨</strong>è¿™ä¸ªå†…éƒ¨æ§½ä½ï¼Œè€Œä¸”è¿™ä¸ªå†…éƒ¨æ§½ä½çš„å€¼ä¹Ÿä¸èƒ½é€šè¿‡æ™®é€šçš„<code>get()</code>å’Œ<code>set()</code> æ“ä½œè®¿é—®åˆ°ï¼Œäºæ˜¯ä»£ç†æ‹¦æˆªåæœ¬åº”è¯¥è½¬å‘ç»™ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•ä¼šæŠ›å‡º<code>TypeError</code><pre id="3b322633-59c7-4625-a39b-bd3fa6588371" class="code code-wrap"><code>const target = new Date();
const proxy = new Proxy(target, {});

console.log(proxy instanceof Date); // true
try {
  proxy.getDate(); // æ— æ³•è·å–
} catch (error) {
  console.log(error.toString()); // TypeError: this is not a Date object.
}</code></pre><ul id="6ad966e5-5802-4ec2-8c6f-2e4be8a161ee" class="bulleted-list"><li style="list-style-type:square"><code>Date</code> å®ä¾‹è°ƒç”¨æ–¹æ³•ä¾èµ–[[NumberDate]]</li></ul><ul id="7894b2b9-1ae2-4500-9053-310a6f640ffb" class="bulleted-list"><li style="list-style-type:square">è€Œ<code>proxy</code>è°ƒç”¨æ–¹æ³•æ—¶ä½¿ç”¨<code>proxy</code>æœ¬èº«ä½œä¸º<code>this</code> ,è¿™ä¸ª<code>this</code>æ²¡æœ‰[[NumberDate]] ä¸”å› ä¸ºå†…éƒ¨æ’æ§½<strong>æ— æ³•é€šè¿‡jsè®¿é—®åˆ°ï¼Œåªèƒ½ä½œä¸ºå¼•æ“è¿è¡ŒJSä»£ç æ—¶çš„å†…éƒ¨å±æ€§è€Œå­˜åœ¨ï¼Œ</strong>æ‰€ä»¥æŠ›å‡ºé”™è¯¯</li></ul></li></ul></li></ul><p id="18edaffe-a591-4224-b26c-bb55148883d1" class="">
</p><p id="256f2752-4d80-4fa9-aed0-1984db0b30dc" class="">
</p></div></div><p id="0d90ca7e-7706-4a24-9f90-334890fe35b2" class="">
</p></div></article><script src="../../gotoBack.js"></script><script src="../../gotoTop.js"></script></body></html>